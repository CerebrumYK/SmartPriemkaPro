{"file_contents":{"README.md":{"content":"# Building Controls App\n\n## üöÄ –†–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ –≤ Replit\n\n1. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π Node.js Repl.\n2. –ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª—ã –ø—Ä–æ–µ–∫—Ç–∞ –∏–∑ —ç—Ç–æ–≥–æ –∞—Ä—Ö–∏–≤–∞.\n3. –í Shell –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:\n   ```bash\n   npm install\n   npm run dev\n   ```\n4. –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (Replit ‚Üí Secrets):\n   - NEXT_PUBLIC_SUPABASE_URL\n   - NEXT_PUBLIC_SUPABASE_ANON_KEY\n5. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ –ø–æ –∞–¥—Ä–µ—Å—É Replit (`https://<your-repl>.repl.co`).\n\n## üóÑÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Supabase\n\n1. –°–æ–∑–¥–∞–π—Ç–µ –ø—Ä–æ–µ–∫—Ç –≤ Supabase.\n2. –í—Å—Ç–∞–≤—å—Ç–µ `server_seed_full.sql` –≤ SQL Editor –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ.\n3. –ò–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ CSV —Å –¥–µ—Ñ–µ–∫—Ç–∞–º–∏ –≤ staging-—Ç–∞–±–ª–∏—Ü—É –∏ –≤—ã–∑–æ–≤–∏—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é `upsert_defect(...)` –¥–ª—è –ø–µ—Ä–µ–Ω–æ—Å–∞.\n4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ –≤—å—é—Ö–∏ `defects_view_v2` / `defects_full_v2`.\n\n## ‚úÖ –ì–æ—Ç–æ–≤–æ\n\n–¢–µ–ø–µ—Ä—å –≤ Replit –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è —Ç–∞–±–ª–∏—Ü–∞ –¥–µ—Ñ–µ–∫—Ç–æ–≤ —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏ –∏ —ç–∫—Å–ø–æ—Ä—Ç–æ–º –≤ DOCX/XLSX.\n","size_bytes":1105},"index.js":{"content":"","size_bytes":0},"kill-port.js":{"content":"// kill-port.js\nconst { execSync } = require('child_process');\n\ntry {\n  // –ü–æ–ø—Ä–æ–±—É–µ–º –Ω–∞–π—Ç–∏ –ø—Ä–æ—Ü–µ—Å—Å, –∫–æ—Ç–æ—Ä—ã–π —Å–ª—É—à–∞–µ—Ç –ø–æ—Ä—Ç 3000\n  const pid = execSync('lsof -t -i:3000 || true').toString().trim();\n  if (pid) {\n    console.log(`‚ö†Ô∏è –£–±–∏–≤–∞–µ–º –ø—Ä–æ—Ü–µ—Å—Å –Ω–∞ –ø–æ—Ä—Ç—É 3000 (PID=${pid})`);\n    execSync(`kill -9 ${pid}`);\n  } else {\n    console.log('‚úÖ –ü–æ—Ä—Ç 3000 —Å–≤–æ–±–æ–¥–µ–Ω');\n  }\n} catch (err) {\n  console.log('‚ÑπÔ∏è –ù–µ —É–¥–∞–ª–æ—Å—å –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ—Ä—Ç 3000, –≤–æ–∑–º–æ–∂–Ω–æ lsof –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç');\n}\n","size_bytes":582},"next-env.d.ts":{"content":"/// <reference types=\"next\" />\n/// <reference types=\"next/image-types/global\" />\n/// <reference types=\"next/navigation-types/compat/navigation\" />\n\n// NOTE: This file should not be edited\n// see https://nextjs.org/docs/basic-features/typescript for more information.\n","size_bytes":267},"next.config.js":{"content":"/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  reactStrictMode: true,\n  async headers() {\n    return [\n      {\n        source: '/(.*)',\n        headers: [\n          {\n            key: 'Cache-Control',\n            value: 'no-cache, no-store, must-revalidate',\n          },\n        ],\n      },\n    ];\n  },\n  experimental: {\n    // Allow connections from any host (required for Replit proxy)\n    allowedHosts: true,\n  },\n};\n\nmodule.exports = nextConfig;\n","size_bytes":468},"postcss.config.js":{"content":"module.exports = {\n  plugins: {\n    tailwindcss: {},\n    autoprefixer: {},\n  },\n};\n","size_bytes":83},"tailwind.config.js":{"content":"/** @type {import('tailwindcss').Config} */\nmodule.exports = {\n  content: [\n    './app/**/*.{js,ts,jsx,tsx}',\n    './components/**/*.{js,ts,jsx,tsx}',\n    './pages/**/*.{js,ts,jsx,tsx}',\n  ],\n  theme: {\n    extend: {\n      colors: {\n        // Supreme Vision —Ü–≤–µ—Ç–æ–≤–∞—è –ø–∞–ª–∏—Ç—Ä–∞\n        supreme: {\n          primary: '#14b8a6', // teal-500 - –æ—Å–Ω–æ–≤–Ω–æ–π —Ü–≤–µ—Ç –ª–æ–≥–æ—Ç–∏–ø–∞\n          secondary: '#0d9488', // teal-600 - —Ç–µ–º–Ω–µ–µ –¥–ª—è hover\n          accent: '#ef4444', // red-500 - –∫—Ä–∞—Å–Ω—ã–π –∞–∫—Ü–µ–Ω—Ç\n          'accent-dark': '#dc2626', // red-600 - —Ç–µ–º–Ω–µ–µ –¥–ª—è hover\n          light: '#5eead4', // teal-300 - —Å–≤–µ—Ç–ª—ã–π –æ—Ç—Ç–µ–Ω–æ–∫\n          dark: '#0f766e', // teal-700 - —Ç–µ–º–Ω—ã–π –æ—Ç—Ç–µ–Ω–æ–∫\n        },\n        // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ü–≤–µ—Ç–∞ –¥–ª—è —Å—Ç–∞—Ç—É—Å–æ–≤\n        status: {\n          critical: '#dc2626', // red-600\n          important: '#f59e0b', // amber-500\n          minor: '#10b981', // emerald-500\n          info: '#3b82f6', // blue-500\n        },\n      },\n      fontFamily: {\n        sans: ['Inter', 'system-ui', '-apple-system', 'sans-serif'],\n      },\n      boxShadow: {\n        supreme: '0 4px 6px -1px rgba(20, 184, 166, 0.1), 0 2px 4px -1px rgba(20, 184, 166, 0.06)',\n      },\n    },\n  },\n  plugins: [],\n};\n","size_bytes":1304},"app/layout.tsx":{"content":"import React from 'react';\n\nexport const metadata = {\n  title: 'Building Controls App',\n  description: 'Defects management and acceptance testing web application',\n};\n\nexport default function RootLayout({ children }: { children: React.ReactNode }) {\n  return (\n    <html lang=\"en\">\n      <body>{children}</body>\n    </html>\n  );\n}\n","size_bytes":331},"app/page.tsx":{"content":"'use client';\n\nimport FiltersBar from '../components/FiltersBar';\nimport DefectsTable from '../components/DefectsTable';\nimport ActionsBar from '../components/ActionsBar';\nimport { FiltersProvider } from '../components/FiltersContext';\n\nexport default function Page() {\n  return (\n    <div className=\"min-h-screen bg-gray-50\">\n      {/* –®–∞–ø–∫–∞ —Å –ª–æ–≥–æ—Ç–∏–ø–æ–º */}\n      <header className=\"bg-white shadow-sm border-b-2 border-supreme-primary\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n          <div className=\"flex items-center justify-between h-16\">\n            <div className=\"flex items-center space-x-3\">\n              <img src=\"/logo.png\" alt=\"Supreme Vision\" className=\"h-10 w-auto\" />\n              <div>\n                <h1 className=\"text-xl font-bold text-gray-900\">–ü—Ä–∏—ë–º–∫–∞ –æ–±—ä–µ–∫—Ç–æ–≤ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏</h1>\n                <p className=\"text-sm text-gray-500\">–°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–µ—Ñ–µ–∫—Ç–∞–º–∏ —Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–∞</p>\n              </div>\n            </div>\n            <div className=\"flex items-center space-x-4\">\n              <div className=\"text-sm text-gray-500\">Supreme Vision</div>\n            </div>\n          </div>\n        </div>\n      </header>\n\n      {/* –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç */}\n      <main className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6\">\n        <FiltersProvider>\n          <FiltersBar />\n          <ActionsBar />\n          <DefectsTable />\n        </FiltersProvider>\n      </main>\n    </div>\n  );\n}\n","size_bytes":1529},"components/ActionsBar.tsx":{"content":"'use client';\nimport { useFilters } from './FiltersContext';\n\nexport default function ActionsBar() {\n  const { selectedIds, clearSelected, filters } = useFilters();\n\n  async function exportFile(format: 'docx' | 'xlsx') {\n    const ids = Array.from(selectedIds);\n    if (ids.length === 0) {\n      alert('–í—ã–±–µ—Ä–∏—Ç–µ —Å—Ç—Ä–æ–∫–∏ –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞.');\n      return;\n    }\n\n    try {\n      const url = `/api/export/${format}?ids=${ids.join(',')}`;\n      const a = document.createElement('a');\n      a.href = url;\n      a.download = `defects_export_${Date.now()}.${format}`;\n      a.click();\n    } catch (error) {\n      console.error('–û—à–∏–±–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞:', error);\n      alert('–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ —ç–∫—Å–ø–æ—Ä—Ç–µ. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.');\n    }\n  }\n\n  function exportAllByFilters(format: 'docx' | 'xlsx') {\n    // TODO: –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —ç–∫—Å–ø–æ—Ä—Ç –≤—Å–µ—Ö –ø–æ —Ñ–∏–ª—å—Ç—Ä–∞–º –≤ —Å–ª–µ–¥—É—é—â–µ–π –≤–µ—Ä—Å–∏–∏\n    alert('–§—É–Ω–∫—Ü–∏—è —ç–∫—Å–ø–æ—Ä—Ç–∞ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö –ø–æ —Ñ–∏–ª—å—Ç—Ä–∞–º –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤ —Å–ª–µ–¥—É—é—â–µ–π –≤–µ—Ä—Å–∏–∏.');\n  }\n\n  function resetFilters() {\n    // –°–±—Ä–æ—Å –≤—Å–µ—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤ –∫—Ä–æ–º–µ page –∏ pageSize\n    const { page, pageSize } = filters;\n    window.location.search = '';\n  }\n\n  const hasFilters =\n    filters.countryId || filters.blockId || filters.typeId || filters.severityId || filters.q;\n  const selectedCount = selectedIds.size;\n\n  return (\n    <div className=\"bg-white shadow-lg rounded-lg p-6 mb-6\">\n      <div className=\"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4\">\n        {/* –≠–∫—Å–ø–æ—Ä—Ç –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö */}\n        <div className=\"flex flex-col sm:flex-row gap-3\">\n          <div className=\"flex items-center gap-2\">\n            <span className=\"text-sm text-gray-600 whitespace-nowrap\">\n              {selectedCount > 0 ? `–í—ã–±—Ä–∞–Ω–æ: ${selectedCount}` : '–≠–∫—Å–ø–æ—Ä—Ç –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö:'}\n            </span>\n          </div>\n          <div className=\"flex gap-2\">\n            <button\n              onClick={() => exportFile('docx')}\n              disabled={selectedCount === 0}\n              className=\"inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-white bg-supreme-primary hover:bg-supreme-secondary disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\n            >\n              <svg className=\"w-4 h-4 mr-2\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                <path\n                  fillRule=\"evenodd\"\n                  d=\"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z\"\n                  clipRule=\"evenodd\"\n                />\n              </svg>\n              DOCX\n            </button>\n            <button\n              onClick={() => exportFile('xlsx')}\n              disabled={selectedCount === 0}\n              className=\"inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-white bg-status-minor hover:bg-green-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\n            >\n              <svg className=\"w-4 h-4 mr-2\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                <path\n                  fillRule=\"evenodd\"\n                  d=\"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z\"\n                  clipRule=\"evenodd\"\n                />\n              </svg>\n              XLSX\n            </button>\n          </div>\n        </div>\n\n        {/* –≠–∫—Å–ø–æ—Ä—Ç –≤—Å–µ—Ö –ø–æ —Ñ–∏–ª—å—Ç—Ä–∞–º */}\n        <div className=\"flex flex-col sm:flex-row gap-3\">\n          <div className=\"flex items-center gap-2\">\n            <span className=\"text-sm text-gray-600 whitespace-nowrap\">\n              –≠–∫—Å–ø–æ—Ä—Ç –≤—Å–µ—Ö –ø–æ —Ñ–∏–ª—å—Ç—Ä–∞–º:\n            </span>\n          </div>\n          <div className=\"flex gap-2\">\n            <button\n              onClick={() => exportAllByFilters('docx')}\n              className=\"inline-flex items-center px-3 py-2 border border-gray-300 text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 transition-colors\"\n            >\n              DOCX (–≤—Å–µ)\n            </button>\n            <button\n              onClick={() => exportAllByFilters('xlsx')}\n              className=\"inline-flex items-center px-3 py-2 border border-gray-300 text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 transition-colors\"\n            >\n              XLSX (–≤—Å–µ)\n            </button>\n          </div>\n        </div>\n\n        {/* –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ */}\n        <div className=\"flex gap-2\">\n          <button\n            onClick={clearSelected}\n            disabled={selectedCount === 0}\n            className=\"inline-flex items-center px-3 py-2 border border-gray-300 text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\n          >\n            <svg className=\"w-4 h-4 mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path\n                strokeLinecap=\"round\"\n                strokeLinejoin=\"round\"\n                strokeWidth={2}\n                d=\"M6 18L18 6M6 6l12 12\"\n              />\n            </svg>\n            –û—á–∏—Å—Ç–∏—Ç—å –≤—ã–±–æ—Ä\n          </button>\n          <button\n            onClick={resetFilters}\n            disabled={!hasFilters}\n            className=\"inline-flex items-center px-3 py-2 border border-gray-300 text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\n          >\n            <svg className=\"w-4 h-4 mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path\n                strokeLinecap=\"round\"\n                strokeLinejoin=\"round\"\n                strokeWidth={2}\n                d=\"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.707A1 1 0 013 7V4z\"\n              />\n            </svg>\n            –°–±—Ä–æ—Å–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n}\n","size_bytes":6469},"components/AddLocation.tsx":{"content":"'use client';\n\nimport { useState, useEffect } from 'react';\nimport supabase from '../lib/supabaseClient';\n\ntype Category = {\n  id: string;\n  name: string;\n};\n\nexport default function AddLocation() {\n  const [name, setName] = useState('');\n  const [category, setCategory] = useState('');\n  const [categories, setCategories] = useState<Category[]>([]);\n  const [message, setMessage] = useState<string | null>(null);\n\n  useEffect(() => {\n    (async () => {\n      const { data, error } = await supabase\n        .from('location_categories')\n        .select('id, name')\n        .order('name');\n      if (error) {\n        console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π:', error.message);\n      } else if (data) {\n        setCategories(data as Category[]);\n      }\n    })();\n  }, []);\n\n  async function handleAdd(e: React.FormEvent) {\n    e.preventDefault();\n    const { error } = await supabase.from('locations').upsert(\n      [\n        {\n          name,\n          category_id: category,\n        },\n      ],\n      { onConflict: 'category_id,name' },\n    );\n\n    if (error) {\n      setMessage('–û—à–∏–±–∫–∞: ' + error.message);\n    } else {\n      setName('');\n      setCategory('');\n      setMessage('‚úÖ –õ–æ–∫–∞—Ü–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∞ (–∏–ª–∏ —É–∂–µ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–ª–∞).');\n    }\n  }\n\n  return (\n    <div className=\"border rounded p-4\">\n      <h2 className=\"font-semibold mb-2\">–î–æ–±–∞–≤–∏—Ç—å –ª–æ–∫–∞—Ü–∏—é</h2>\n      <form onSubmit={handleAdd} className=\"flex gap-2 mb-2 flex-wrap\">\n        <input\n          type=\"text\"\n          placeholder=\"–ù–∞–∑–≤–∞–Ω–∏–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä: –°–ø–∞–ª—å–Ω—è)\"\n          value={name}\n          onChange={(e) => setName(e.target.value)}\n          className=\"border p-2 rounded\"\n          required\n        />\n        <select\n          value={category}\n          onChange={(e) => setCategory(e.target.value)}\n          className=\"border p-2 rounded\"\n          required\n        >\n          <option value=\"\">–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é</option>\n          {categories.map((c) => (\n            <option key={c.id} value={c.id}>\n              {c.name}\n            </option>\n          ))}\n        </select>\n        <button type=\"submit\" className=\"bg-green-600 text-white px-4 py-2 rounded\">\n          –î–æ–±–∞–≤–∏—Ç—å\n        </button>\n      </form>\n      {message && <p className=\"text-sm\">{message}</p>}\n    </div>\n  );\n}\n","size_bytes":2381},"components/AuthButton.tsx":{"content":"'use client';\n\nimport { useState, useEffect } from 'react';\nimport supabase from '../lib/supabaseClient';\n\ntype Category = {\n  id: string;\n  name: string;\n};\n\nexport default function AddLocation() {\n  const [name, setName] = useState('');\n  const [category, setCategory] = useState('');\n  const [categories, setCategories] = useState<Category[]>([]);\n  const [message, setMessage] = useState<string | null>(null);\n\n  useEffect(() => {\n    (async () => {\n      const { data } = await supabase.from('location_categories').select('id, name').order('name');\n      if (data) setCategories(data as Category[]);\n    })();\n  }, []);\n\n  async function handleAdd(e: React.FormEvent) {\n    e.preventDefault();\n    const { error } = await supabase.from('locations').insert([{ name, category_id: category }]);\n    if (error) {\n      setMessage('–û—à–∏–±–∫–∞: ' + error.message);\n    } else {\n      setName('');\n      setCategory('');\n      setMessage('‚úÖ –õ–æ–∫–∞—Ü–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∞!');\n    }\n  }\n\n  return (\n    <div className=\"border rounded p-4\">\n      <h2 className=\"font-semibold mb-2\">–î–æ–±–∞–≤–∏—Ç—å –ª–æ–∫–∞—Ü–∏—é</h2>\n      <form onSubmit={handleAdd} className=\"flex gap-2 mb-2 flex-wrap\">\n        <input\n          type=\"text\"\n          placeholder=\"–ù–∞–∑–≤–∞–Ω–∏–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä: –°–ø–∞–ª—å–Ω—è)\"\n          value={name}\n          onChange={(e) => setName(e.target.value)}\n          className=\"border p-2 rounded\"\n          required\n        />\n        <select\n          value={category}\n          onChange={(e) => setCategory(e.target.value)}\n          className=\"border p-2 rounded\"\n          required\n        >\n          <option value=\"\">–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é</option>\n          {categories.map((c) => (\n            <option key={c.id} value={c.id}>\n              {c.name}\n            </option>\n          ))}\n        </select>\n        <button type=\"submit\" className=\"bg-green-600 text-white px-4 py-2 rounded\">\n          –î–æ–±–∞–≤–∏—Ç—å\n        </button>\n      </form>\n      {message && <p className=\"text-sm\">{message}</p>}\n    </div>\n  );\n}\n","size_bytes":2069},"components/DefectsTable.tsx":{"content":"'use client';\nimport { useEffect, useState } from 'react';\nimport Link from 'next/link';\nimport supabase from '../lib/supabaseClient';\nimport { useFilters } from './FiltersContext';\n\ntype Row = {\n  id: string;\n  problem: string;\n  description: string | null;\n  solution: string | null;\n  norm_display: string | null;\n  severity_order: number | null;\n  severity_name: string | null;\n  country_name: string;\n  block_name: string;\n  type_name: string;\n  location_category_name: string | null;\n  location_name: string | null;\n};\n\nexport default function DefectsTable() {\n  const { filters, setFilters, selectedIds, toggleSelected } = useFilters();\n  const [rows, setRows] = useState<Row[]>([]);\n  const [total, setTotal] = useState<number>(0);\n  const [error, setError] = useState<string | null>(null);\n  const [loading, setLoading] = useState<boolean>(false);\n  const {\n    page,\n    pageSize,\n    countryId,\n    blockId,\n    typeId,\n    severityId,\n    locationCategoryId,\n    locationId,\n    q,\n  } = filters;\n\n  useEffect(() => {\n    (async () => {\n      try {\n        setLoading(true);\n        let query = supabase.from('defects_view_v2').select('*', { count: 'exact' });\n\n        if (countryId) query = query.eq('country_id', countryId);\n        if (blockId) query = query.eq('block_id', blockId);\n        if (typeId) query = query.eq('type_id', typeId);\n        if (severityId) query = query.eq('severity_id', severityId);\n        // TODO: –¥–æ–±–∞–≤–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã –ø–æ –ª–æ–∫–∞—Ü–∏–∏ –∫–æ–≥–¥–∞ –ø–æ–ª—è –±—É–¥—É—Ç –≤ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–∏\n        // if (locationCategoryId) query = query.eq(\"location_category_id\", locationCategoryId);\n        // if (locationId) query = query.eq(\"location_id\", locationId);\n        if (q)\n          query = query.or(\n            `problem.ilike.%${q}%,description.ilike.%${q}%,solution.ilike.%${q}%,norm_display.ilike.%${q}%`,\n          );\n\n        query = query.order('severity_order', { ascending: true });\n\n        const from = (page - 1) * pageSize;\n        const to = from + pageSize - 1;\n        const { data, count, error } = await query.range(from, to);\n\n        if (error) {\n          console.error('Error fetching defects:', error);\n          setError('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –æ–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É.');\n          setRows([]);\n          setTotal(0);\n          return;\n        }\n\n        setError(null);\n        setRows((data as Row[]) || []);\n        setTotal(count || 0);\n      } catch (error) {\n        console.error('Unexpected error:', error);\n        setError('–ü—Ä–æ–∏–∑–æ—à–ª–∞ –Ω–µ–ø—Ä–µ–¥–≤–∏–¥–µ–Ω–Ω–∞—è –æ—à–∏–±–∫–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –æ–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É.');\n        setRows([]);\n        setTotal(0);\n      } finally {\n        setLoading(false);\n      }\n    })();\n  }, [page, pageSize, countryId, blockId, typeId, severityId, q]);\n\n  const totalPages = Math.max(1, Math.ceil(total / pageSize));\n\n  const getSeverityColor = (severityName: string | null) => {\n    switch (severityName?.toLowerCase()) {\n      case '–∫—Ä–∏—Ç–∏—á–Ω–æ':\n        return 'bg-status-critical text-white';\n      case '—Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ':\n        return 'bg-status-important text-white';\n      case '–Ω–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ':\n        return 'bg-status-minor text-white';\n      case '–∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω–æ':\n        return 'bg-status-info text-white';\n      default:\n        return 'bg-gray-100 text-gray-800';\n    }\n  };\n\n  return (\n    <div className=\"bg-white shadow-lg rounded-lg overflow-hidden\">\n      {error && (\n        <div className=\"bg-red-50 border-l-4 border-red-400 p-4 mb-4\" role=\"alert\">\n          <div className=\"flex\">\n            <div className=\"flex-shrink-0\">\n              <svg className=\"h-5 w-5 text-red-400\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n                <path\n                  fillRule=\"evenodd\"\n                  d=\"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z\"\n                  clipRule=\"evenodd\"\n                />\n              </svg>\n            </div>\n            <div className=\"ml-3 flex-1\">\n              <p className=\"text-sm text-red-700\">{error}</p>\n              <button\n                onClick={() => window.location.reload()}\n                className=\"mt-2 bg-red-600 text-white px-3 py-1 rounded text-sm hover:bg-red-700 transition-colors\"\n              >\n                –û–±–Ω–æ–≤–∏—Ç—å\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {loading && (\n        <div className=\"flex justify-center items-center p-8\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-supreme-primary\"></div>\n          <span className=\"ml-2 text-gray-600\">–ó–∞–≥—Ä—É–∑–∫–∞...</span>\n        </div>\n      )}\n\n      <div className=\"overflow-x-auto\">\n        <table className=\"min-w-full divide-y divide-gray-200\">\n          <thead className=\"bg-gray-50\">\n            <tr>\n              <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                <input\n                  type=\"checkbox\"\n                  className=\"rounded border-gray-300 text-supreme-primary focus:ring-supreme-primary\"\n                />\n              </th>\n              <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                –°—Ç—Ä–∞–Ω–∞\n              </th>\n              <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                –ë–ª–æ–∫\n              </th>\n              <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                –¢–∏–ø\n              </th>\n              <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                –ü—Ä–æ–±–ª–µ–º–∞\n              </th>\n              <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                –û–ø–∏—Å–∞–Ω–∏–µ\n              </th>\n              <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                –†–µ—à–µ–Ω–∏–µ\n              </th>\n              <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                –ù–æ—Ä–º–∞\n              </th>\n              <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                –ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å\n              </th>\n              <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                –õ–æ–∫–∞—Ü–∏—è\n              </th>\n            </tr>\n          </thead>\n          <tbody className=\"bg-white divide-y divide-gray-200\">\n            {rows.map((r) => (\n              <tr key={r.id} className=\"hover:bg-gray-50 transition-colors\">\n                <td className=\"px-6 py-4 whitespace-nowrap\">\n                  <input\n                    type=\"checkbox\"\n                    checked={selectedIds.has(r.id)}\n                    onChange={() => toggleSelected(r.id)}\n                    className=\"rounded border-gray-300 text-supreme-primary focus:ring-supreme-primary\"\n                    aria-label={`–í—ã–±—Ä–∞—Ç—å —Å—Ç—Ä–æ–∫—É: ${r.problem}`}\n                  />\n                </td>\n                <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                  {r.country_name}\n                </td>\n                <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                  {r.block_name}\n                </td>\n                <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">{r.type_name}</td>\n                <td className=\"px-6 py-4 text-sm\">\n                  <Link\n                    href={`/defect/${r.id}`}\n                    className=\"text-supreme-primary hover:text-supreme-secondary font-medium transition-colors\"\n                  >\n                    {r.problem}\n                  </Link>\n                </td>\n                <td className=\"px-6 py-4 text-sm text-gray-600 max-w-xs truncate\">\n                  {r.description || '‚Äî'}\n                </td>\n                <td className=\"px-6 py-4 text-sm text-gray-600 max-w-xs truncate\">\n                  {r.solution || '‚Äî'}\n                </td>\n                <td className=\"px-6 py-4 text-sm text-gray-600\">{r.norm_display || '‚Äî'}</td>\n                <td className=\"px-6 py-4 whitespace-nowrap\">\n                  <span\n                    className={`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${getSeverityColor(r.severity_name)}`}\n                  >\n                    {r.severity_name || '–ù–µ —É–∫–∞–∑–∞–Ω–æ'}\n                  </span>\n                </td>\n                <td className=\"px-6 py-4 text-sm text-gray-600\">\n                  {r.location_category_name && r.location_name\n                    ? `${r.location_category_name} / ${r.location_name}`\n                    : r.location_category_name || r.location_name || '‚Äî'}\n                </td>\n              </tr>\n            ))}\n            {!loading && rows.length === 0 && (\n              <tr>\n                <td className=\"px-6 py-12 text-center text-gray-500\" colSpan={10}>\n                  <div className=\"flex flex-col items-center\">\n                    <svg\n                      className=\"h-12 w-12 text-gray-400 mb-4\"\n                      fill=\"none\"\n                      viewBox=\"0 0 24 24\"\n                      stroke=\"currentColor\"\n                    >\n                      <path\n                        strokeLinecap=\"round\"\n                        strokeLinejoin=\"round\"\n                        strokeWidth={2}\n                        d=\"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\"\n                      />\n                    </svg>\n                    <p className=\"text-lg font-medium\">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö</p>\n                    <p className=\"text-sm\">–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã</p>\n                  </div>\n                </td>\n              </tr>\n            )}\n          </tbody>\n        </table>\n      </div>\n\n      {/* –ü–∞–≥–∏–Ω–∞—Ü–∏—è */}\n      <div className=\"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6\">\n        <div className=\"flex-1 flex justify-between items-center\">\n          <div className=\"flex items-center text-sm text-gray-700\">\n            <span>\n              –ü–æ–∫–∞–∑–∞–Ω–æ {(page - 1) * pageSize + 1} - {Math.min(page * pageSize, total)} –∏–∑ {total}{' '}\n              –∑–∞–ø–∏—Å–µ–π\n            </span>\n          </div>\n\n          <div className=\"flex items-center gap-2\">\n            <select\n              value={pageSize}\n              onChange={(e) => setFilters({ pageSize: Number(e.target.value) })}\n              className=\"border border-gray-300 rounded-md px-3 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-supreme-primary focus:border-supreme-primary\"\n              aria-label=\"–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ\"\n            >\n              <option value={50}>50 –Ω–∞ —Å—Ç—Ä.</option>\n              <option value={100}>100 –Ω–∞ —Å—Ç—Ä.</option>\n              <option value={200}>200 –Ω–∞ —Å—Ç—Ä.</option>\n            </select>\n\n            <nav\n              className=\"relative z-0 inline-flex rounded-md shadow-sm -space-x-px\"\n              aria-label=\"–ü–∞–≥–∏–Ω–∞—Ü–∏—è\"\n            >\n              <button\n                disabled={page <= 1}\n                onClick={() => setFilters({ page: 1 })}\n                className=\"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed\"\n                aria-label=\"–ü–µ—Ä–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞\"\n              >\n                ¬´¬´\n              </button>\n              <button\n                disabled={page <= 1}\n                onClick={() => setFilters({ page: page - 1 })}\n                className=\"relative inline-flex items-center px-2 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed\"\n                aria-label=\"–ü—Ä–µ–¥—ã–¥—É—â–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞\"\n              >\n                ‚Äπ\n              </button>\n              <span className=\"relative inline-flex items-center px-4 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-700\">\n                {page} / {totalPages}\n              </span>\n              <button\n                disabled={page >= totalPages}\n                onClick={() => setFilters({ page: page + 1 })}\n                className=\"relative inline-flex items-center px-2 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed\"\n                aria-label=\"–°–ª–µ–¥—É—é—â–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞\"\n              >\n                ‚Ä∫\n              </button>\n              <button\n                disabled={page >= totalPages}\n                onClick={() => setFilters({ page: totalPages })}\n                className=\"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed\"\n                aria-label=\"–ü–æ—Å–ª–µ–¥–Ω—è—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞\"\n              >\n                ¬ª¬ª\n              </button>\n            </nav>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n","size_bytes":13784},"components/FiltersBar.tsx":{"content":"'use client';\nimport { useEffect, useState, useRef, useCallback } from 'react';\nimport supabase from '../lib/supabaseClient';\nimport { useFilters } from './FiltersContext';\n\ntype Opt = { id: string; name: string };\ntype Sev = { id: number; name: string };\n\nexport default function FiltersBar() {\n  const { filters, setFilters } = useFilters();\n  const [countries, setCountries] = useState<Opt[]>([]);\n  const [blocks, setBlocks] = useState<Opt[]>([]);\n  const [types, setTypes] = useState<Opt[]>([]);\n  const [severities, setSeverities] = useState<Sev[]>([]);\n  const [locationCategories, setLocationCategories] = useState<Opt[]>([]);\n  const [locations, setLocations] = useState<Opt[]>([]);\n  const searchTimeoutRef = useRef<ReturnType<typeof setTimeout> | null>(null);\n\n  useEffect(() => {\n    (async () => {\n      try {\n        const { data: c, error: cError } = await supabase\n          .from('countries')\n          .select('id,name')\n          .eq('is_enabled', true);\n        const { data: b, error: bError } = await supabase.from('blocks').select('id,name');\n        const { data: s, error: sError } = await supabase\n          .from('severity_levels')\n          .select('id,name')\n          .order('sort_order');\n        const { data: lc, error: lcError } = await supabase\n          .from('location_categories')\n          .select('id,name');\n\n        if (cError) console.error('Error fetching countries:', cError);\n        if (bError) console.error('Error fetching blocks:', bError);\n        if (sError) console.error('Error fetching severities:', sError);\n        if (lcError) console.error('Error fetching location categories:', lcError);\n\n        setCountries(c || []);\n        setBlocks(b || []);\n        setSeverities(s || []);\n        setLocationCategories(lc || []);\n      } catch (error) {\n        console.error('Unexpected error loading filters:', error);\n      }\n    })();\n  }, []);\n\n  useEffect(() => {\n    (async () => {\n      try {\n        if (!filters.blockId) {\n          setTypes([]);\n          return;\n        }\n        const { data: t, error } = await supabase\n          .from('defect_types')\n          .select('id,name')\n          .eq('block_id', filters.blockId);\n\n        if (error) {\n          console.error('Error fetching types:', error);\n          setTypes([]);\n          return;\n        }\n\n        setTypes(t || []);\n      } catch (error) {\n        console.error('Unexpected error loading types:', error);\n        setTypes([]);\n      }\n    })();\n  }, [filters.blockId]);\n\n  useEffect(() => {\n    (async () => {\n      try {\n        if (!filters.locationCategoryId) {\n          setLocations([]);\n          return;\n        }\n        const { data: l, error } = await supabase\n          .from('locations')\n          .select('id,name')\n          .eq('category_id', filters.locationCategoryId);\n\n        if (error) {\n          console.error('Error fetching locations:', error);\n          setLocations([]);\n          return;\n        }\n\n        setLocations(l || []);\n      } catch (error) {\n        console.error('Unexpected error loading locations:', error);\n        setLocations([]);\n      }\n    })();\n  }, [filters.locationCategoryId]);\n\n  // Cleanup timeout on unmount\n  useEffect(() => {\n    return () => {\n      if (searchTimeoutRef.current) {\n        clearTimeout(searchTimeoutRef.current);\n      }\n    };\n  }, []);\n\n  return (\n    <div className=\"bg-white shadow-lg rounded-lg p-6 mb-6\">\n      <h2 className=\"text-lg font-semibold text-gray-800 mb-4\">–§–∏–ª—å—Ç—Ä—ã</h2>\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 xl:grid-cols-6 gap-4\">\n        {/* –°—Ç—Ä–∞–Ω–∞ */}\n        <select\n          className=\"border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-teal-500 bg-white\"\n          value={filters.countryId || ''}\n          onChange={(e) => setFilters({ countryId: e.target.value || undefined })}\n          aria-label=\"–í—ã–±–æ—Ä —Å—Ç—Ä–∞–Ω—ã\"\n        >\n          <option value=\"\">–°—Ç—Ä–∞–Ω–∞</option>\n          {countries.map((o) => (\n            <option key={o.id} value={o.id}>\n              {o.name}\n            </option>\n          ))}\n        </select>\n\n        {/* –ë–ª–æ–∫ */}\n        <select\n          className=\"border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-teal-500 bg-white\"\n          value={filters.blockId || ''}\n          onChange={(e) => setFilters({ blockId: e.target.value || undefined, typeId: undefined })}\n          aria-label=\"–í—ã–±–æ—Ä –±–ª–æ–∫–∞\"\n        >\n          <option value=\"\">–ë–ª–æ–∫</option>\n          {blocks.map((o) => (\n            <option key={o.id} value={o.id}>\n              {o.name}\n            </option>\n          ))}\n        </select>\n\n        {/* –¢–∏–ø */}\n        <select\n          className=\"border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-teal-500 bg-white\"\n          value={filters.typeId || ''}\n          onChange={(e) => setFilters({ typeId: e.target.value || undefined })}\n          disabled={!filters.blockId}\n          aria-label=\"–í—ã–±–æ—Ä —Ç–∏–ø–∞ –¥–µ—Ñ–µ–∫—Ç–∞\"\n        >\n          <option value=\"\">–¢–∏–ø</option>\n          {types.map((o) => (\n            <option key={o.id} value={o.id}>\n              {o.name}\n            </option>\n          ))}\n        </select>\n\n        {/* –ö–∞—Ç–µ–≥–æ—Ä–∏—è –ª–æ–∫–∞—Ü–∏–∏ */}\n        <select\n          className=\"border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-teal-500 bg-white\"\n          value={filters.locationCategoryId || ''}\n          onChange={(e) =>\n            setFilters({ locationCategoryId: e.target.value || undefined, locationId: undefined })\n          }\n          aria-label=\"–í—ã–±–æ—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ª–æ–∫–∞—Ü–∏–∏\"\n        >\n          <option value=\"\">–ö–∞—Ç–µ–≥–æ—Ä–∏—è –ª–æ–∫–∞—Ü–∏–∏</option>\n          {locationCategories.map((o) => (\n            <option key={o.id} value={o.id}>\n              {o.name}\n            </option>\n          ))}\n        </select>\n\n        {/* –õ–æ–∫–∞—Ü–∏—è */}\n        <select\n          className=\"border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-teal-500 bg-white\"\n          value={filters.locationId || ''}\n          onChange={(e) => setFilters({ locationId: e.target.value || undefined })}\n          disabled={!filters.locationCategoryId}\n          aria-label=\"–í—ã–±–æ—Ä –ª–æ–∫–∞—Ü–∏–∏\"\n        >\n          <option value=\"\">–õ–æ–∫–∞—Ü–∏—è</option>\n          {locations.map((o) => (\n            <option key={o.id} value={o.id}>\n              {o.name}\n            </option>\n          ))}\n        </select>\n\n        {/* –ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å */}\n        <select\n          className=\"border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-teal-500 bg-white\"\n          value={filters.severityId || ''}\n          onChange={(e) =>\n            setFilters({ severityId: e.target.value ? Number(e.target.value) : undefined })\n          }\n          aria-label=\"–í—ã–±–æ—Ä —É—Ä–æ–≤–Ω—è –∫—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç–∏\"\n        >\n          <option value=\"\">–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å</option>\n          {severities.map((s) => (\n            <option key={s.id} value={s.id}>\n              {s.name}\n            </option>\n          ))}\n        </select>\n      </div>\n\n      {/* –ü–æ–∏—Å–∫ */}\n      <div className=\"mt-4\">\n        <input\n          className=\"w-full border border-gray-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-teal-500\"\n          placeholder=\"–ü–æ–∏—Å–∫ –ø–æ –ø—Ä–æ–±–ª–µ–º–∞–º, –æ–ø–∏—Å–∞–Ω–∏—é –∏ –Ω–æ—Ä–º–∞–º...\"\n          value={filters.q || ''}\n          onChange={(e) => {\n            const value = e.target.value.replace(/[,()]/g, ' '); // Sanitize search input\n            if (searchTimeoutRef.current) {\n              clearTimeout(searchTimeoutRef.current);\n            }\n            searchTimeoutRef.current = setTimeout(() => {\n              setFilters({ q: value.trim() || undefined });\n            }, 300);\n          }}\n          aria-label=\"–ü–æ–∏—Å–∫ –ø–æ –ø—Ä–æ–±–ª–µ–º–∞–º, –æ–ø–∏—Å–∞–Ω–∏—é –∏ –Ω–æ—Ä–º–∞–º\"\n        />\n      </div>\n    </div>\n  );\n}\n","size_bytes":8279},"components/FiltersContext.tsx":{"content":"'use client';\nimport React, { createContext, useContext, useMemo, useState } from 'react';\n\ntype Filters = {\n  countryId?: string;\n  blockId?: string;\n  typeId?: string;\n  severityId?: number;\n  locationCategoryId?: string;\n  locationId?: string;\n  q?: string;\n  page: number;\n  pageSize: number;\n};\n\ntype Ctx = {\n  filters: Filters;\n  setFilters: (f: Partial<Filters>) => void;\n  selectedIds: Set<string>;\n  toggleSelected: (id: string) => void;\n  clearSelected: () => void;\n};\n\nconst FiltersCtx = createContext<Ctx | null>(null);\n\nexport function FiltersProvider({ children }: { children: React.ReactNode }) {\n  const [filters, setFiltersState] = useState<Filters>({ page: 1, pageSize: 50 });\n  const [selectedIds, setSelectedIds] = useState<Set<string>>(new Set());\n\n  function setFilters(partial: Partial<Filters>) {\n    setFiltersState((prev) => ({ ...prev, ...partial, page: 1 }));\n  }\n\n  function toggleSelected(id: string) {\n    setSelectedIds((prev) => {\n      const next = new Set(prev);\n      if (next.has(id)) next.delete(id);\n      else next.add(id);\n      return next;\n    });\n  }\n\n  function clearSelected() {\n    setSelectedIds(new Set());\n  }\n\n  const value = useMemo(\n    () => ({ filters, setFilters, selectedIds, toggleSelected, clearSelected }),\n    [filters, selectedIds],\n  );\n\n  return <FiltersCtx.Provider value={value}>{children}</FiltersCtx.Provider>;\n}\n\nexport function useFilters() {\n  const ctx = useContext(FiltersCtx);\n  if (!ctx) throw new Error('useFilters must be used inside <FiltersProvider>');\n  return ctx;\n}\n","size_bytes":1548},"components/Gallery.tsx":{"content":"'use client';\nimport { useEffect, useState } from 'react';\nimport supabase from '../lib/supabaseClient';\n\ntype MediaFile = {\n  id: string;\n  path: string;\n  tags: string[] | null;\n};\n\nexport default function Gallery({ defectId }: { defectId: string }) {\n  const [photos, setPhotos] = useState<{ url: string; tags: string[] }[]>([]);\n  const [filter, setFilter] = useState<string>('');\n\n  useEffect(() => {\n    (async () => {\n      const { data: media, error } = await supabase\n        .from('media_files')\n        .select('id, path, tags')\n        .eq('defect_id', defectId);\n\n      if (error) {\n        console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ media_files:', error.message);\n        return;\n      }\n\n      if (!media) return;\n\n      const signedPhotos: { url: string; tags: string[] }[] = [];\n\n      for (const m of media as MediaFile[]) {\n        const { data: signed, error: signError } = await supabase.storage\n          .from('media')\n          .createSignedUrl(m.path, 300);\n\n        if (!signError && signed?.signedUrl) {\n          signedPhotos.push({\n            url: signed.signedUrl,\n            tags: m.tags || [],\n          });\n        }\n      }\n\n      setPhotos(signedPhotos);\n    })();\n  }, [defectId]);\n\n  const filtered = filter\n    ? photos.filter((p) => p.tags.some((tag) => tag.toLowerCase().includes(filter.toLowerCase())))\n    : photos;\n\n  return (\n    <div>\n      <div className=\"mb-4\">\n        <input\n          className=\"border p-2 rounded\"\n          placeholder=\"–§–∏–ª—å—Ç—Ä –ø–æ —Ç–µ–≥–∞–º...\"\n          value={filter}\n          onChange={(e) => setFilter(e.target.value)}\n        />\n      </div>\n\n      {filtered.length === 0 && <p>–§–æ—Ç–æ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</p>}\n\n      <div className=\"grid grid-cols-2 md:grid-cols-3 gap-4\">\n        {filtered.map((p, i) => (\n          <div key={i} className=\"border rounded p-2 shadow-sm\">\n            <img src={p.url} alt={`–§–æ—Ç–æ ${i}`} className=\"w-full h-40 object-cover rounded\" />\n            {p.tags.length > 0 && (\n              <div className=\"mt-1 text-xs text-gray-500\">–¢–µ–≥–∏: {p.tags.join(', ')}</div>\n            )}\n          </div>\n        ))}\n      </div>\n    </div>\n  );\n}\n","size_bytes":2164},"components/Measurements.tsx":{"content":"'use client';\nimport { useEffect, useState } from 'react';\nimport supabase from '../lib/supabaseClient';\n\ntype Measurement = {\n  id: number;\n  name: string;\n  value: string | null;\n  unit: string | null;\n  created_at: string;\n};\n\nexport default function Measurements({ defectId }: { defectId: string }) {\n  const [list, setList] = useState<Measurement[]>([]);\n  const [name, setName] = useState('');\n  const [value, setValue] = useState('');\n  const [unit, setUnit] = useState('');\n  const [loading, setLoading] = useState(false);\n  const [errorMsg, setErrorMsg] = useState<string | null>(null);\n\n  async function load() {\n    const { data, error } = await supabase\n      .from('defect_measurements')\n      .select('*')\n      .eq('defect_id', defectId)\n      .order('created_at', { ascending: false });\n\n    if (error) {\n      setErrorMsg(error.message);\n    } else {\n      setList(data as Measurement[]);\n    }\n  }\n\n  async function addMeasurement(e: React.FormEvent) {\n    e.preventDefault();\n    setLoading(true);\n    setErrorMsg(null);\n\n    const { error } = await supabase\n      .from('defect_measurements')\n      .insert([{ defect_id: defectId, name, value, unit }]);\n\n    setLoading(false);\n\n    if (error) {\n      setErrorMsg(error.message);\n    } else {\n      setName('');\n      setValue('');\n      setUnit('');\n      await load();\n    }\n  }\n\n  useEffect(() => {\n    load();\n  }, [defectId]);\n\n  return (\n    <div className=\"border rounded p-4\">\n      <h2 className=\"font-semibold mb-2\">–ò–∑–º–µ—Ä–µ–Ω–∏—è</h2>\n      {errorMsg && <p className=\"text-red-600\">{errorMsg}</p>}\n\n      <form onSubmit={addMeasurement} className=\"flex gap-2 mb-4 flex-wrap\">\n        <input\n          type=\"text\"\n          placeholder=\"–ü–∞—Ä–∞–º–µ—Ç—Ä\"\n          value={name}\n          onChange={(e) => setName(e.target.value)}\n          className=\"border p-2 rounded\"\n          required\n        />\n        <input\n          type=\"text\"\n          placeholder=\"–ó–Ω–∞—á–µ–Ω–∏–µ\"\n          value={value}\n          onChange={(e) => setValue(e.target.value)}\n          className=\"border p-2 rounded\"\n        />\n        <input\n          type=\"text\"\n          placeholder=\"–ï–¥–∏–Ω–∏—Ü–∞\"\n          value={unit}\n          onChange={(e) => setUnit(e.target.value)}\n          className=\"border p-2 rounded\"\n        />\n        <button\n          type=\"submit\"\n          className=\"bg-blue-600 text-white px-4 py-2 rounded\"\n          disabled={loading}\n        >\n          –î–æ–±–∞–≤–∏—Ç—å\n        </button>\n      </form>\n\n      <table className=\"border-collapse border w-full text-sm\">\n        <thead>\n          <tr>\n            <th className=\"border p-2\">–ü–∞—Ä–∞–º–µ—Ç—Ä</th>\n            <th className=\"border p-2\">–ó–Ω–∞—á–µ–Ω–∏–µ</th>\n            <th className=\"border p-2\">–ï–¥.</th>\n            <th className=\"border p-2\">–î–∞—Ç–∞</th>\n          </tr>\n        </thead>\n        <tbody>\n          {list.map((m) => (\n            <tr key={m.id}>\n              <td className=\"border p-2\">{m.name}</td>\n              <td className=\"border p-2\">{m.value || ''}</td>\n              <td className=\"border p-2\">{m.unit || ''}</td>\n              <td className=\"border p-2\">{new Date(m.created_at).toLocaleString('ru-RU')}</td>\n            </tr>\n          ))}\n          {list.length === 0 && (\n            <tr>\n              <td colSpan={4} className=\"border p-2 text-center\">\n                –ù–µ—Ç –∏–∑–º–µ—Ä–µ–Ω–∏–π\n              </td>\n            </tr>\n          )}\n        </tbody>\n      </table>\n    </div>\n  );\n}\n","size_bytes":3488},"lib/supabaseClient.ts":{"content":"import { createClient } from '@supabase/supabase-js';\n\nconst supabase = createClient(\n  process.env.NEXT_PUBLIC_SUPABASE_URL!,\n  process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,\n);\n\nexport default supabase;\n","size_bytes":202},"styles/globals.css":{"content":"@tailwind base;\n@tailwind components;\n@tailwind utilities;\n","size_bytes":59},"app/defect/[id]/error.tsx":{"content":"'use client';\nexport default function Error() {\n  return <main className=\"p-4 text-red-600\">–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –¥–µ—Ñ–µ–∫—Ç–∞</main>;\n}\n","size_bytes":154},"app/defect/[id]/loading.tsx":{"content":"export default function Loading() {\n  return <main className=\"p-4\">–ó–∞–≥—Ä—É–∑–∫–∞‚Ä¶</main>;\n}\n","size_bytes":97},"app/defect/[id]/page.tsx":{"content":"'use client';\n\nimport { useEffect, useState } from 'react';\nimport supabase from '../../../lib/supabaseClient';\nimport Gallery from '../../../components/Gallery';\nimport Measurements from '../../../components/Measurements';\nimport AuthButton from '../../../components/AuthButton';\nimport AddLocation from '../../../components/AddLocation';\n\ntype Defect = {\n  id: string;\n  country_name: string;\n  block_name: string;\n  type_name: string;\n  problem: string;\n  description: string | null;\n  solution: string | null;\n  norm_display: string | null;\n  norm_source_url: string | null;\n  severity_name: string | null;\n  location_category_name: string | null;\n  location_name: string | null;\n};\n\nexport default function DefectPage({ params }: { params: { id: string } }) {\n  const { id } = params;\n  const [row, setRow] = useState<Defect | null>(null);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    (async () => {\n      const { data, error } = await supabase\n        .from('defects_full_v2')\n        .select('*')\n        .eq('id', id)\n        .single();\n      if (!error) setRow(data as Defect);\n      setLoading(false);\n    })();\n  }, [id]);\n\n  if (loading) return <main className=\"p-4\">–ó–∞–≥—Ä—É–∑–∫–∞‚Ä¶</main>;\n  if (!row) return <main className=\"p-4\">–î–µ—Ñ–µ–∫—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω</main>;\n\n  return (\n    <main className=\"p-4 space-y-4\">\n      <a href=\"/\" className=\"text-blue-600 underline text-sm\">\n        ‚Üê –ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É\n      </a>\n\n      <AuthButton />\n\n      <h1 className=\"text-2xl font-bold\">–î–µ—Ñ–µ–∫—Ç: {row.problem}</h1>\n\n      <div className=\"grid md:grid-cols-2 gap-4\">\n        {/* –ö–∞—Ä—Ç–æ—á–∫–∞ —Å –¥–∞–Ω–Ω—ã–º–∏ –¥–µ—Ñ–µ–∫—Ç–∞ */}\n        <div className=\"border rounded p-4 space-y-2\">\n          <div>\n            <span className=\"font-semibold\">–°—Ç—Ä–∞–Ω–∞:</span> {row.country_name}\n          </div>\n          <div>\n            <span className=\"font-semibold\">–ë–ª–æ–∫ / –¢–∏–ø:</span> {row.block_name} / {row.type_name}\n          </div>\n          <div>\n            <span className=\"font-semibold\">–õ–æ–∫–∞—Ü–∏—è:</span> {row.location_category_name}{' '}\n            {row.location_name ? `‚Üí ${row.location_name}` : ''}\n          </div>\n          <div>\n            <span className=\"font-semibold\">–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å:</span> {row.severity_name || '‚Äî'}\n          </div>\n          <div>\n            <span className=\"font-semibold\">–û–ø–∏—Å–∞–Ω–∏–µ:</span> {row.description || '‚Äî'}\n          </div>\n          <div>\n            <span className=\"font-semibold\">–†–µ—à–µ–Ω–∏–µ:</span> {row.solution || '‚Äî'}\n          </div>\n          <div>\n            <span className=\"font-semibold\">–ù–æ—Ä–º–∞:</span>{' '}\n            {row.norm_display ? (\n              row.norm_source_url ? (\n                <a\n                  className=\"text-blue-600 underline\"\n                  href={row.norm_source_url}\n                  target=\"_blank\"\n                  rel=\"noreferrer\"\n                >\n                  {row.norm_display}\n                </a>\n              ) : (\n                row.norm_display\n              )\n            ) : (\n              '‚Äî'\n            )}\n          </div>\n        </div>\n\n        {/* –ì–∞–ª–µ—Ä–µ—è —Ñ–æ—Ç–æ */}\n        <div className=\"border rounded p-4\">\n          <h2 className=\"font-semibold mb-2\">–ì–∞–ª–µ—Ä–µ—è</h2>\n          <Gallery defectId={row.id} />\n        </div>\n      </div>\n\n      {/* –ò–∑–º–µ—Ä–µ–Ω–∏—è */}\n      <Measurements defectId={row.id} />\n\n      {/* –î–æ–±–∞–≤–∏—Ç—å –ª–æ–∫–∞—Ü–∏—é */}\n      <AddLocation />\n    </main>\n  );\n}\n","size_bytes":3546},"pages/api/export/docx.js":{"content":"import { Document, Packer, Paragraph, Table, TableRow, TableCell } from 'docx';\nimport supabase from '../../../lib/supabaseClient';\n\nexport default async function handler(req, res) {\n  const ids = (req.query.ids || '').split(',').filter(Boolean);\n  const { data: defects } = await supabase\n    .from('defects_full_v2')\n    .select('problem,solution,norm_display')\n    .in('id', ids);\n\n  const rows = (defects || []).map(\n    (d) =>\n      new TableRow({\n        children: [\n          new TableCell({ children: [new Paragraph(d.problem)] }),\n          new TableCell({ children: [new Paragraph(d.solution || '')] }),\n          new TableCell({ children: [new Paragraph(d.norm_display || '')] }),\n        ],\n      }),\n  );\n\n  const doc = new Document({\n    sections: [{ children: [new Paragraph('–û—Ç—á—ë—Ç –ø–æ –ø—Ä–∏—ë–º–∫–µ'), new Table({ rows })] }],\n  });\n\n  const buffer = await Packer.toBuffer(doc);\n  res.setHeader('Content-Disposition', 'attachment; filename=report.docx');\n  res.send(buffer);\n}\n","size_bytes":1000},"pages/api/export/xlsx.js":{"content":"import * as XLSX from 'xlsx';\nimport supabase from '../../../lib/supabaseClient';\n\nexport default async function handler(req, res) {\n  const ids = (req.query.ids || '').split(',').filter(Boolean);\n  const { data: defects } = await supabase\n    .from('defects_full_v2')\n    .select('problem,solution,norm_display')\n    .in('id', ids);\n\n  const ws = XLSX.utils.json_to_sheet(defects || []);\n  const wb = XLSX.utils.book_new();\n  XLSX.utils.book_append_sheet(wb, ws, 'Defects');\n\n  const buf = XLSX.write(wb, { type: 'buffer', bookType: 'xlsx' });\n  res.setHeader('Content-Disposition', 'attachment; filename=report.xlsx');\n  res.send(buf);\n}\n","size_bytes":640},"AGENTS.md":{"content":"# Copilot Agent Instructions\n\n- –í—Å–µ–≥–¥–∞ –≤—ã–ø–æ–ª–Ω—è–π `npm install` –ø–µ—Ä–µ–¥ `npm run build`.\n- –ü–µ—Ä–µ–¥ —Ç–µ—Å—Ç–∞–º–∏ –∑–∞–ø—É—Å–∫–∞–π `npm run lint`.\n- –ï—Å–ª–∏ —Å–±–æ—Ä–∫–∞ –ø–∞–¥–∞–µ—Ç ‚Äî –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏ –ø–æ–≤—Ç–æ—Ä–∏.\n- –î–ª—è –ë–î –∏—Å–ø–æ–ª—å–∑—É–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –ø—Ä–æ–µ–∫—Ç–∞ (–º–∏–≥—Ä–∞—Ü–∏–∏/seed).\n","size_bytes":384},"eslint.config.js":{"content":"import js from \"@eslint/js\";\nimport typescriptPlugin from \"@typescript-eslint/eslint-plugin\";\nimport typescriptParser from \"@typescript-eslint/parser\";\n\n/** @type {import(\"eslint\").Linter.FlatConfig} */\nexport default [\n  js, // Flat config –¥–ª—è JS\n  {\n    files: [\"**/*.ts\", \"**/*.tsx\"],\n    languageOptions: {\n      parser: typescriptParser,\n      parserOptions: {\n        project: \"./tsconfig.json\",\n      },\n    },\n    plugins: { \"@typescript-eslint\": typescriptPlugin },\n    rules: {\n      ...typescriptPlugin.configs.recommended.rules,\n      // –≤–∞—à–∏ –∫–∞—Å—Ç–æ–º–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞\n    },\n  },\n];","size_bytes":610},"replit.md":{"content":"# acceptance-web-app-pro\n\n## Overview\n\nThis is a defects management and acceptance testing web application built with Next.js and Supabase. The application allows users to view, filter, and export defects data in a tabular format. It provides functionality to manage construction or quality control defects with detailed information including problem descriptions, solutions, severity levels, and associated media files.\n\nThe application features a responsive interface for browsing defects with advanced filtering capabilities, user authentication via Supabase Auth, and export functionality to DOCX and XLSX formats. Users can also view detailed defect pages with associated measurements and photo galleries.\n\n## User Preferences\n\nPreferred communication style: Simple, everyday language.\n\n## System Architecture\n\n### Frontend Architecture\n\n- **Framework**: Next.js 13 with App Router architecture\n- **Styling**: Tailwind CSS for responsive design and utility-first styling\n- **State Management**: React Context API for filters and selection state management\n- **TypeScript**: Used throughout for type safety and better development experience\n\n### Backend Architecture\n\n- **API Routes**: Next.js API routes for export functionality (DOCX/XLSX generation)\n- **Database Integration**: Direct client-side queries to Supabase using the JavaScript client\n- **Authentication**: Supabase Auth with magic link email authentication\n\n### Data Storage Solutions\n\n- **Primary Database**: Supabase (PostgreSQL) with custom views for data aggregation\n- **File Storage**: Supabase Storage for media files (photos, documents)\n- **Database Views**:\n  - `defects_view_v2` for paginated defects listing\n  - `defects_full_v2` for detailed defect information\n- **Key Tables**:\n  - `defects` - main defects data\n  - `countries`, `blocks`, `defect_types` - hierarchical categorization\n  - `severity_levels` - defect severity classification\n  - `locations`, `location_categories` - spatial organization\n  - `media_files` - associated photos and documents\n  - `defect_measurements` - measurement data\n\n### Authentication and Authorization\n\n- **Provider**: Supabase Auth\n- **Method**: Magic link email authentication (passwordless)\n- **Row Level Security**: Implemented through Supabase policies\n- **User Session**: Managed client-side with automatic token refresh\n\n### Component Architecture\n\n- **Context Providers**: FiltersContext for centralized filter state\n- **Reusable Components**:\n  - FiltersBar for dynamic filtering interface\n  - DefectsTable for paginated data display\n  - ActionsBar for bulk operations\n  - Gallery for media file display with signed URLs\n- **Page Structure**: App Router with nested layouts and dynamic routes\n\n## External Dependencies\n\n### Core Services\n\n- **Supabase**: PostgreSQL database, authentication, file storage, and real-time subscriptions\n- **Next.js**: React framework with server-side rendering and API routes\n\n### Third-party Libraries\n\n- **docx**: Document generation for DOCX export functionality\n- **xlsx**: Spreadsheet generation for XLSX export functionality\n- **@supabase/supabase-js**: Official Supabase JavaScript client library\n- **Tailwind CSS**: Utility-first CSS framework for styling\n\n### Development Dependencies\n\n- **TypeScript**: Static type checking\n- **PostCSS**: CSS processing with Autoprefixer\n- **React**: UI library with hooks for state management\n\n### Environment Configuration\n\n- `NEXT_PUBLIC_SUPABASE_URL`: Supabase project URL\n- `NEXT_PUBLIC_SUPABASE_ANON_KEY`: Supabase anonymous key for client-side access\n\n### File Export System\n\n- Server-side generation of DOCX files using the docx library\n- XLSX export using the xlsx library for spreadsheet format\n- Dynamic file download through API routes with proper content headers\n","size_bytes":3774},"setup.sh":{"content":"#!/bin/bash\n\necho \"=== Buildings_control: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Å—Ä–µ–¥—ã ===\"\n\n# 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è Node.js –∏ npm\nif ! command -v node >/dev/null 2>&1; then\n  echo \"Node.js –Ω–µ –Ω–∞–π–¥–µ–Ω. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Node.js —Å https://nodejs.org/\"\n  exit 1\nfi\nif ! command -v npm >/dev/null 2>&1; then\n  echo \"npm –Ω–µ –Ω–∞–π–¥–µ–Ω. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ npm (–æ–±—ã—á–Ω–æ –≤—Ö–æ–¥–∏—Ç –≤–º–µ—Å—Ç–µ —Å Node.js).\"\n  exit 1\nfi\n\necho \"Node.js –≤–µ—Ä—Å–∏—è: $(node -v)\"\necho \"npm –≤–µ—Ä—Å–∏—è: $(npm -v)\"\n\n# 2. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)\n# git clone https://github.com/CerebrumYK/Buildings_control.git\n# cd Buildings_control\n\n# 3. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π\necho \"–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º npm –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏...\"\nnpm install\n\n# 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è\nif [ ! -f .env.local ]; then\n  if [ -f .env.example ]; then\n    echo \".env.local –Ω–µ –Ω–∞–π–¥–µ–Ω. –ö–æ–ø–∏—Ä—É–µ–º .env.example ‚Üí .env.local\"\n    cp .env.example .env.local\n    echo \"–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ .env.local —Å–≤–æ–∏–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–ª—é—á–∏ Supabase)!\"\n  else\n    echo \"–í–Ω–∏–º–∞–Ω–∏–µ: .env.local –∏ .env.example –Ω–µ –Ω–∞–π–¥–µ–Ω—ã. –°–æ–∑–¥–∞–π—Ç–µ .env.local –≤—Ä—É—á–Ω—É—é.\"\n  fi\nelse\n  echo \".env.local –Ω–∞–π–¥–µ–Ω.\"\nfi\n\n# 5. –õ–∏–Ω—Ç–∏–Ω–≥ –∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ\necho \"–ó–∞–ø—É—Å–∫ –ª–∏–Ω—Ç–µ—Ä–∞ (npm run lint)...\"\nnpm run lint || echo \"–õ–∏–Ω—Ç–∏–Ω–≥ –∑–∞–≤–µ—Ä—à–∏–ª—Å—è —Å –æ—à–∏–±–∫–∞–º–∏. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏—Ö!\"\n\n# 6. –°–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞\necho \"–°–æ–±–∏—Ä–∞–µ–º –ø—Ä–æ–µ–∫—Ç (npm run build)...\"\nnpm run build || { echo \"–û—à–∏–±–∫–∞ —Å–±–æ—Ä–∫–∏!\"; exit 1; }\n\n# 7. –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ (–µ—Å–ª–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ)\nif npm run | grep -q 'test'; then\n  echo \"–ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ (npm run test)...\"\n  npm run test || echo \"–í–Ω–∏–º–∞–Ω–∏–µ: –Ω–µ –≤—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—à–ª–∏ —É—Å–ø–µ—à–Ω–æ.\"\nelse\n  echo \"–¢–µ—Å—Ç—ã –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã (–Ω–µ—Ç —Å–∫—Ä–∏–ø—Ç–∞ test –≤ package.json).\"\nfi\n\n# 8. –ó–∞–ø—É—Å–∫ dev-—Å–µ—Ä–≤–µ—Ä–∞\necho \"–ó–∞–ø—É—Å–∫ dev-—Å–µ—Ä–≤–µ—Ä–∞ (npm run dev)...\"\nnpm run dev\n\necho \"=== –í—Å—ë –≥–æ—Ç–æ–≤–æ! –û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:3000 –≤ –±—Ä–∞—É–∑–µ—Ä–µ. ===\"","size_bytes":2346}},"version":1}